Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import pandas as pd
from datasets.frs.imputations.income import SPI_TAB_FOLDER, generate_spi_table
from datasets.frs.frs import FRS_2019_20
from survey_enhance.percentile_matching import match_percentiles

spi = pd.read_csv(SPI_TAB_FOLDER / "put1920uk.tab", delimiter="\t")
spi = generate_spi_table(spi)

frs = FRS_2019_20().load()

percentile_matched_variables = [
    "employment_income",
    "self_employment_income",
    "pension_income",
    "dividend_income",
    "savings_interest_income",
]

new_values = {}

for variable in frs.keys():
    if variable not in percentile_matched_variables:
        new_values[variable] = frs[variable][...]
    else:
        new_values[variable] = match_percentiles(
            frs[variable][...], spi[variable]
        )
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mModuleNotFoundError[0m                       Traceback (most recent call last)
Cell [0;32mIn[1], line 2[0m
[1;32m      1[0m [38;5;28;01mimport[39;00m [38;5;21;01mpandas[39;00m [38;5;28;01mas[39;00m [38;5;21;01mpd[39;00m
[0;32m----> 2[0m [38;5;28;01mfrom[39;00m [38;5;21;01mdatasets[39;00m[38;5;21;01m.[39;00m[38;5;21;01mfrs[39;00m[38;5;21;01m.[39;00m[38;5;21;01mimputations[39;00m[38;5;21;01m.[39;00m[38;5;21;01mincome[39;00m [38;5;28;01mimport[39;00m SPI_TAB_FOLDER, generate_spi_table
[1;32m      3[0m [38;5;28;01mfrom[39;00m [38;5;21;01mdatasets[39;00m[38;5;21;01m.[39;00m[38;5;21;01mfrs[39;00m[38;5;21;01m.[39;00m[38;5;21;01mfrs[39;00m [38;5;28;01mimport[39;00m FRS_2019_20
[1;32m      4[0m [38;5;28;01mfrom[39;00m [38;5;21;01msurvey_enhance[39;00m[38;5;21;01m.[39;00m[38;5;21;01mpercentile_matching[39;00m [38;5;28;01mimport[39;00m match_percentiles

File [0;32m~/work/survey-enhance/survey-enhance/docs/uk_experiments/datasets/frs/__init__.py:3[0m
[1;32m      1[0m [38;5;28;01mfrom[39;00m [38;5;21;01m.[39;00m[38;5;21;01mraw_frs[39;00m [38;5;28;01mimport[39;00m RawFRS_2019_20
[1;32m      2[0m [38;5;28;01mfrom[39;00m [38;5;21;01m.[39;00m[38;5;21;01mfrs[39;00m [38;5;28;01mimport[39;00m FRS_2019_20
[0;32m----> 3[0m [38;5;28;01mfrom[39;00m [38;5;21;01m.[39;00m[38;5;21;01mspi_enhanced_frs[39;00m [38;5;28;01mimport[39;00m SPIEnhancedFRS2019_20
[1;32m      4[0m [38;5;28;01mfrom[39;00m [38;5;21;01m.[39;00m[38;5;21;01mcalibrated_frs[39;00m [38;5;28;01mimport[39;00m CalibratedFRS
[1;32m      5[0m [38;5;28;01mfrom[39;00m [38;5;21;01m.[39;00m[38;5;21;01mpercentile_matched_frs[39;00m [38;5;28;01mimport[39;00m PercentileMatchedFRS

File [0;32m~/work/survey-enhance/survey-enhance/docs/uk_experiments/datasets/frs/spi_enhanced_frs.py:1[0m
[0;32m----> 1[0m [38;5;28;01mfrom[39;00m [38;5;21;01msurvey_enhance[39;00m[38;5;21;01m.[39;00m[38;5;21;01mimpute[39;00m [38;5;28;01mimport[39;00m Imputation
[1;32m      2[0m [38;5;28;01mfrom[39;00m [38;5;21;01msurvey_enhance[39;00m[38;5;21;01m.[39;00m[38;5;21;01mdataset[39;00m [38;5;28;01mimport[39;00m Dataset
[1;32m      3[0m [38;5;28;01mfrom[39;00m [38;5;21;01mpathlib[39;00m [38;5;28;01mimport[39;00m Path

File [0;32m~/work/survey-enhance/survey-enhance/survey_enhance/impute.py:4[0m
[1;32m      2[0m [38;5;28;01mfrom[39;00m [38;5;21;01mtyping[39;00m [38;5;28;01mimport[39;00m List, Dict
[1;32m      3[0m [38;5;28;01mimport[39;00m [38;5;21;01mnumpy[39;00m [38;5;28;01mas[39;00m [38;5;21;01mnp[39;00m
[0;32m----> 4[0m [38;5;28;01mfrom[39;00m [38;5;21;01msklearn[39;00m[38;5;21;01m.[39;00m[38;5;21;01mensemble[39;00m [38;5;28;01mimport[39;00m RandomForestRegressor
[1;32m      5[0m [38;5;28;01mfrom[39;00m [38;5;21;01mtqdm[39;00m [38;5;28;01mimport[39;00m tqdm
[1;32m      8[0m [38;5;28;01mdef[39;00m [38;5;21mto_array[39m(values) [38;5;241m-[39m[38;5;241m>[39m np[38;5;241m.[39mndarray:

[0;31mModuleNotFoundError[0m: No module named 'sklearn'
ModuleNotFoundError: No module named 'sklearn'

